{{define "content"}}
<div>
    {{template "repo-header" .}}

    <h2 class="text-xs uppercase tracking-wider text-[var(--color-text-muted)] mb-6">Repository Settings</h2>

    <!-- General settings -->
    <section class="mb-10">
        <form method="POST" action="/{{.RepoName}}/-/settings" class="border border-[var(--color-border)] p-5 space-y-4 max-w-lg">
            <div>
                <label for="description" class="block text-xs text-[var(--color-text-dim)] mb-1">Description</label>
                <input type="text" id="description" name="description" value="{{.Description}}"
                       class="w-full bg-[var(--color-bg)] border border-[var(--color-border)] px-3 py-2 text-sm text-[var(--color-text)] focus:outline-none focus:border-[var(--color-accent)]" />
            </div>
            <div>
                <label for="default_branch" class="block text-xs text-[var(--color-text-dim)] mb-1">Default Branch</label>
                <input type="text" id="default_branch" name="default_branch" value="{{.DefaultBranch}}"
                       class="w-full bg-[var(--color-bg)] border border-[var(--color-border)] px-3 py-2 text-sm text-[var(--color-text)] focus:outline-none focus:border-[var(--color-accent)]" />
            </div>
            <div class="flex items-center gap-2">
                <input type="checkbox" id="is_private" name="is_private" {{if .IsPrivate}}checked{{end}} class="accent-[var(--color-accent)]" />
                <label for="is_private" class="text-xs text-[var(--color-text-dim)]">Private repository</label>
            </div>
            <button type="submit" class="border border-[var(--color-border)] text-[var(--color-text)] px-4 py-2 text-xs uppercase tracking-wider hover:bg-[var(--color-surface)] hover:text-white cursor-pointer">Save Changes</button>
        </form>
    </section>

    <!-- Webhooks -->
    <section class="mb-10">
        <h2 class="text-xs uppercase tracking-wider text-[var(--color-text-muted)] mb-3">Webhooks</h2>
        <div class="border border-[var(--color-border)] mb-4">
            {{if .Webhooks}}
            {{range .Webhooks}}
            <div class="flex items-center justify-between px-4 py-2.5 border-b border-[var(--color-border-light)] last:border-0">
                <div>
                    <code class="text-sm text-[var(--color-text)]">{{.URL}}</code>
                    {{if not .Active}}<span class="ml-2 text-xs text-[var(--color-text-muted)]">(inactive)</span>{{end}}
                </div>
                <form method="POST" action="/{{$.RepoName}}/-/webhooks/{{.ID}}/delete" hx-post="/{{$.RepoName}}/-/webhooks/{{.ID}}/delete" hx-confirm="Delete this webhook?">
                    <button type="submit" class="text-xs text-red-400 hover:text-red-300 cursor-pointer">delete</button>
                </form>
            </div>
            {{end}}
            {{else}}
            <div class="px-4 py-6 text-center text-[var(--color-text-muted)] text-xs">No webhooks configured.</div>
            {{end}}
        </div>

        <form method="POST" action="/{{.RepoName}}/-/webhooks" class="border border-[var(--color-border)] p-4 space-y-3 max-w-lg">
            <div>
                <label for="webhook_url" class="block text-xs text-[var(--color-text-dim)] mb-1">Payload URL</label>
                <input type="url" id="webhook_url" name="url" required placeholder="https://example.com/webhook"
                       class="w-full bg-[var(--color-bg)] border border-[var(--color-border)] px-3 py-2 text-sm text-[var(--color-text)] focus:outline-none focus:border-[var(--color-accent)]" />
            </div>
            <div>
                <label for="webhook_secret" class="block text-xs text-[var(--color-text-dim)] mb-1">Secret (optional)</label>
                <input type="text" id="webhook_secret" name="secret" placeholder="optional shared secret for HMAC"
                       class="w-full bg-[var(--color-bg)] border border-[var(--color-border)] px-3 py-2 text-sm text-[var(--color-text)] focus:outline-none focus:border-[var(--color-accent)]" />
            </div>
            <button type="submit" class="border border-[var(--color-border)] text-[var(--color-text)] px-4 py-2 text-xs uppercase tracking-wider hover:bg-[var(--color-surface)] hover:text-white cursor-pointer">Add Webhook</button>
        </form>
    </section>

    <!-- Rename -->
    <section class="mb-10">
        <h2 class="text-xs uppercase tracking-wider text-[var(--color-text-muted)] mb-3">Rename Repository</h2>
        <form method="POST" action="/{{.RepoName}}/-/rename" class="border border-[var(--color-border)] p-4 flex items-end gap-3 max-w-lg">
            <div class="flex-1">
                <label for="new_name" class="block text-xs text-[var(--color-text-dim)] mb-1">New Name</label>
                <input type="text" id="new_name" name="new_name" required value="{{.RepoName}}"
                       class="w-full bg-[var(--color-bg)] border border-[var(--color-border)] px-3 py-2 text-sm text-[var(--color-text)] focus:outline-none focus:border-[var(--color-accent)]" />
            </div>
            <button type="submit" class="border border-[var(--color-border)] text-[var(--color-text)] px-4 py-2 text-xs uppercase tracking-wider hover:bg-[var(--color-surface)] hover:text-white cursor-pointer whitespace-nowrap">Rename</button>
        </form>
    </section>

    <!-- Danger Zone -->
    <section class="mb-10">
        <h2 class="text-xs uppercase tracking-wider text-red-400 mb-3">Danger Zone</h2>
        <div class="border border-red-900 p-5">
            <p class="text-xs text-[var(--color-text-dim)] mb-4">Deleting a repository is permanent and cannot be undone.</p>
            <form method="POST" action="/{{.RepoName}}/-/delete" hx-post="/{{.RepoName}}/-/delete" hx-confirm="Are you sure you want to delete {{.RepoName}}? This cannot be undone.">
                <button type="submit" class="border border-red-800 text-red-400 px-4 py-2 text-xs uppercase tracking-wider hover:bg-red-900/30 hover:text-red-300 cursor-pointer">Delete Repository</button>
            </form>
        </div>
    </section>
</div>
{{end}}
